		windows Native Peing Connector -NPC-

	バージョン:　　ver.1.1.0
	リリース:　　　2021-04-29
	開発・配布元:　ACT Laboratory　(https://actlab.org/)
	主要開発者:　　吹雪
　　ソフト種別:　　オープンソースソフトウェア　(GitHubリポジトリ:https://github.com/actlaboratory/NPC/)
　　ライセンス:　　Apache License 2.0

第１章　はじめに
１．１　windows Native Peing Connector(NPC)の概要
windows Native Peing Connector(NPC)は、Twitter質問箱の愛称で親しまれているウェブサービス「Peing」(https://peing.net/)をWindowsのGUIから便利に利用するためのツールです。
このサービスでは、ウェブ上で質問箱を開設したユーザに対して、匿名で質問を送ることができます。
質問を受け取った開設者は、公開の場で回答します。
詳細については、運営元のウェブサイトを確認してください。

NPCでは、このサービスが提供する機能の内、回答済みの質問の閲覧、匿名またはログイン状態での質問投稿、届いた質問への回答をwindowsのGUI上から簡単な操作で行うことができます。
また、閲覧の為に受信した回答のデータはお使いのPCに保存します。回答者がアカウントや回答を削除した場合にも、手元にデータを残すことができます。

なお、サービスへのアクセスは通信の解析により実現されているため、将来的な利用は保証されていません。
運営元による通信仕様の変更があった場合などには、予告なく利用できなくなる場合があります。
NPCの使い方、NPCでの通信エラー等について、Peing運営元への問い合わせは絶対に行わないよう、ご協力をお願いします。

１．２　動作環境について
64ビット版Windows10で動作確認を行っています。
多くの場合、Windowsの他のバージョンでも動作すると思われます。

NPCはWindowsの標準的なコントロールのみを使用しており、画面読み上げソフトなどの支援技術と一緒に使用できます。


第２章　セットアップ
２．１　インストール
NPCを使用するに当たって、特別なインストール作業は必要ありません。
ダウンロードしたzipファイルを適当な場所に展開し、「NPC」フォルダ内の「NPC.exe」を実行すると起動します。

２．２　アンインストール
NPCをコンピュータから削除する場合は、「NPC」フォルダを削除してください。
その他、特別な作業は不要です。

２．３　アップデート
発見された不具合の修正、新機能の追加、Peingの仕様変更への対応などの目的で、バージョンアップを行う場合があります。
新しいバージョンが利用可能な場合、NPCの起動時にメッセージが表示されます。
指示に従って操作してください。


第３章　基本操作
この章では、NPCの基本操作を説明します。
各メニュー項目や設定項目の詳細については、第４章を参照してください。

３．１　アカウントの登録
NPCを起動すると、リストビューが表示されます。初めて起動したときは、空のビューとなります。
始めに、回答を閲覧したい相手のアカウントをNPCに登録する必要があります。
まず、相手のPeingページ(SNS等で周知されている質問募集ページ)のURLを控えておきます。
次に、メニューバーの[ファイル]→[ユーザの追加](キーボードショートカットは、Ctrl+A)を実行し、表示されたダイアログに相手のアカウント名(半角英数)またはPeingページのURLを入力し、[OK]を押すことでアカウントを登録できます。
この操作を登録したいアカウントの数だけ繰り返します。
もし、アカウントを調べるのは面倒だけど、まずはNPCを試してみたい！という方は、NPCを開発しているACT Laboratoryの最年少メンバーのアカウント「guredora403」を入力してみてください。

３．２　ビューの更新
登録したアカウントで過去に回答された質問を受信し、画面に表示するにはビューの更新操作を行う必要があります。
メニューバーの[ファイル]→[最新の情報に更新](キーボードショートカットは、Ctrl+rまたはF5)を実行すると、Peingと通信してビューを更新します。

３．３　質問と回答の閲覧
アカウントの登録とビューの更新を行うと、画面上のリストビューに質問と回答が表示されます。
回答は、日時が新しいものほど上に並びます。
表示項目は、回答者のアカウント名、質問内容、回答内容、回答日時、質問種別です。
質問種別は、通常の質問の場合空欄になります。

もし、文字が長くて画面に収まりきっていない場合や、スクリーンリーダを利用して内容を１文字ずつ確認したい場合は、該当の回答にカーソルを合わせ、[Enter]キーを押すか、マウスでダブルクリックすることで、ダイアログに表示することができます。

この他、届いた質問への回答などについては、第４章で解説します。


第４章　メニューリファレンス
ここでは、NPCの各メニュー項目について解説します。
また、メニューを選択することによって表示される設定画面の内容についても記載しています。

ほとんどのメニュー項目には、メニューを呼び出さずに該当する項目を実行できるショートカットキーが用意されています。
ショートカットキーは自由に変更できますが、ここでは初期値として設定されているショートカットキーを、「」で囲んで記載します。

４．１　ファイル
４．１．１　ユーザの追加 「ctrl+a」
回答を閲覧する対象とするユーザを追加登録します。
この項目を選択すると、[ユーザの追加]というダイアログボックスが表示されます。
回答者のアカウント名(半角英数)または質問募集ページのURLを入力し、[OK]ボタンを押すと登録されます。

４．１．２　質問を投稿 「ctrl+return」
リスト上でカーソルを合わせている回答の回答者に、質問を送ることができます。
この項目を選択すると、[質問を投稿]というダイアログボックスが表示されます。
質問内容を入力し、[OK]ボタンを押すと、質問が送信されます。
送信できる質問には長さの上限や使用できる文字種の制限等があるかもしれませんが、NPCでは確認を行っていません。
質問の送信に失敗した場合には、短く単純な内容でお試しください。

なお、４．４．１．１．４においてログイン状態で質問するよう設定していた場合には、ログインのため、投稿に少し時間がかかる場合があります。


４．１．３　最新の情報に更新 「ctrl+r/F5」
Peingと通信し、登録した回答者の最新の回答を受信してビューに反映させます。

４．１．４　ユーザを削除 「ctrl+d/delete」
リスト上でカーソルを合わせている回答の回答者をNPCから削除します。
削除したユーザの回答はすべてビューから消え、今後そのユーザの回答はPeingから取得去れなくなります。
Peingには回答の削除機能があるため、再度同じユーザを登録しても現在ビューに表示されているすべての回答を受信できない可能性があることに注意してください。

４．１．５　詳細情報を表示　「return」
リスト上でカーソルを合わせている回答の詳細を、ダイアログ上で確認することができます。

４．１．６　ユーザ情報を表示　「shift+return」
リスト上でカーソルを合わせている回答の回答者の情報を、ダイアログ上で確認することができます。
表示項目はアカウント名、回答状況(回答済み質問数、受信質問数、回答率)、フォロイー数、プロフィールです。
この内、フォロイー数はpeing上でそのユーザがタイムライン表示するよう設定しているユーザの数です。

４．１．７　ブラウザでユーザのページを開く　「ctrl+shift+return」
リスト上でカーソルを合わせている回答の回答者の質問募集ページをブラウザで開きます。
NPCからの回答の取得や質問の投稿がうまくいかない際には、ここからブラウザを開いて状況を確認してみてください。

４．１．８　表示中のリスト内容をCSVファイルにエクスポート　「ctrl+E」
表示しているリストと同じ内容をCSVファイルにエクスポート(書き出し)します。
この項目を実行すると、windows標準のファイル選択ダイアログが開きます。ダイアログで保存先を決定すると、ファイルへのエクスポート(書き出し)が行われます。
なお、この機能で出力されるファイルは、ビューでの表示内容と同様、後述のフィルタの影響を受けます。

出力されるファイルは、各項目間をタブ文字で区切って表示したテキストファイルで、文字はCP932でエンコードされています。
この形式のファイルは、Microsoft Excelなどで読み込んで使用することができます。

４．１．９　登録済みユーザリスト　「F4」
４．１．１や４．１．10で回答の閲覧対象として登録したユーザの一覧を確認することができます。
この項目を選択すると、[登録済みユーザ一覧]というダイアログボックスが表示されます。
リストビューでは、ユーザの表示名とアカウント名を確認することができます。
リストビューで任意のユーザにカーソルを合わせたうえで[詳細]ボタンを押すと、当該ユーザの詳細情報をダイアログで表示します。
[フィルタ]ボタンを押すと、４．２．３で後述する[選択中ユーザのみ表示]のフィルタを当該ユーザに対して適用してダイアログを閉じます。
[削除]ボタンまたは[delete]キーを押すと、４．１．４と同様に当該ユーザの登録を削除します。
[質問を投稿]ボタンを押すと、４．１．２と同様に当該ユーザへ質問を送ることができます。

４．１．10　Twitterのフォローリストから一括登録
短文投稿SNSのTwitterにおいて指定したユーザがフォローしているユーザのリストを取得し、リスト内のアカウントを回答の閲覧対象として追加登録します。
この機能は、多くのユーザがTwitterからの連携によりPeingに登録し、PeingIDとTwitterのアカウント名が一致していることに着目して作られたものです。
そのため、指定したアカウントがフォローしているユーザのPeingアカウントが登録されなかったり、逆に関係のないアカウントが登録されてしまったりする場合があります。
登録前には最終確認のダイアログを表示しますので、必ず内容を確認してから実行してください。

この機能を利用するには、利用者がTwitterのアカウントを所有している必要があります。
また、Twitterの通信制限の為、この機能を連続して利用する場合、必ず15分間以上時間を空ける必要があります。

この項目を選択すると、ブラウザが起動し、Twitterへのログインを求められます。
ブラウザを操作し、TwitterのIDとパスワードを入力してください。
もし、入力後に「このブラウザは現在サポートされていません。」という画面が表示された場合には、IDまたはパスワードが間違っていますので、[Alt+左カーソル]等の操作で前の画面に戻り、再度入力してください。
入力に成功すると、NPCに対してアカウントの利用を許可するか否かを問う画面が表示されます。内容を確認後、許可の操作を行ってください。
利用しているブラウザによっては、この後にセキュリティの警告などが２度程度表示される場合がありますが、問題のないものですので[はい]を押してください。

すべての操作が終了後、NPCに戻ると、[対象ユーザの指定]というダイアログボックスが表示されますので、フォローリストを取得したいユーザのアカウント(@guredora403のような半角英数と_のみで構成された@で始まる文字列)を入力し、[OK]を押してください。
ここで指定できるアカウントは、先の手順でログインに用いたアカウント、公開アカウント、もしくは先の手順でログインに用いたアカウントからフォローしている非公開アカウントのいずれかであり、フォロー数が3,000未満のものに限られます。フォロー数3,000超のアカウントを指定した場合、リスト内の3,000件のみが取得されます。

入力後は、リストの取得などのため、しばらく時間がかかります。
通信が完了すると、[登録候補ユーザの確認]ダイアログボックスが表示されます。ここには、指定したユーザがフォローしており、かつNPCに登録されていないアカウントが一覧表示されています。
[詳細]ボタンを押すと、カーソルを合わせたアカウントの詳細(回答件数や自己紹介など)を確認することができます。
[削除]ボタンまたは[delete]キーを押すと、カーソルを合わせたアカウントを一覧から削除します。
最後に、[OK]を押すと、一覧に表示されているすべてのアカウントを登録し、ダイアログが閉じます。

４．１．11　終了　「Alt+F4」
NPCを終了します。

４．２　フィルタ
４．２．１　運営からの質問を非表示
Peingで投稿される質問には、幾つかの種類があります。
この項目を実行すると、Peingの運営者から自動的に送られた質問を非表示にすることができます。
もう一度この項目を実行すると、このフィルタを解除することができます。

４．２．２　バトン質問を非表示
この項目を実行すると、Peingのバトン機能を利用して送られた質問を非表示にすることができます。
もう一度この項目を実行すると、このフィルタを解除することができます。
なお、バトン機能は過去に期間限定で実装されていたもので、本稿執筆の2021年3月現在では新規にバトン質問を送ることはできません。

４．２．３　選択中ユーザのみ表示
リスト上でカーソルを合わせている回答の回答者以外の回答を非表示にすることができます。
１つのアカウントの回答のみを表示したい場合に使用します。
もう一度この項目を実行すると、このフィルタを解除することができます。

４．３　アカウント
このメニューには、アカウントへのログインを行ったうえで利用する機能が集められています。
利用する前に、４．４．１．１．２および４．４．１．１．３で説明する設定機能を用いて、PeingのIDとパスワードを設定しておく必要があります。

４．３．１　届いている質問に回答
届いている質問への回答と、質問のアーカイブ操作を行うことができます。
この項目を選択すると、[届いている質問に回答]というダイアログが表示されます。
ダイアログの表示には、通信環境によって少し時間がかかる場合があります。未回答の質問がない場合、ダイアログは表示されますが、リストビューに項目がない状態となります。
表示されたダイアログには、未回答の質問があればその内容が表示されます。
[回答する]ボタンを押すと、[回答の入力]ダイアログが表示され、カーソルを合わせた質問に対する回答内容を入力することができます。なお、入力に対する制限の考え方などについては、前述の質問の登校時と同じです。
[アーカイブ]ボタンを押すと、カーソルを合わせた質問をアーカイブすることができます。

４．３．２　アーカイブ済みの質問を表示
過去にアーカイブした質問を一覧表示し、回答または元に戻す操作ができます。
ダイアログ内の操作は４．３．１のものと同じです。

４．３．３　送信した質問を表示
この項目を選択すると、[送信した質問]というダイアログが表示されます。
リストビューでは、過去にログインした状態で送信した質問と、相手から回答された内容を確認することができます。
まだ回答されていない質問、ログインしていない状態で行った質問は表示されません。

４．３．４　アカウント設定
ログインしているPeingアカウントの一部の設定を変更することができます。
この項目を選択すると、[アカウント設定]というダイアログが表示されます。表示されたダイアログには、初期値として現在設定中の内容が表示されます。
[名前]は、他のユーザから見える名前です。日本語や絵文字も使用可能です。
[プロフィール]は、自己紹介などを設定することができます。
NPCでは、試用できる文字の種類や長さについて確認を行っていません。そのため、設定が完了した場合であっても、正しく反映されていることを保証できません。
設定後には、このダイアログを再度開くなどして、設定が正しく反映されたことを必ずご自身でご確認ください。


４．４　オプション
４．４．１　設定
NPCの動作に関する様々な設定を行うことができます。
この項目を選択すると、各種設定を行うためのダイアログボックスが表示されます。

このダイアログボックスは、複数のタブ（ページ）で構成されています。
Ctrl+Tab、Ctrl+Shift+Tabを押すと、表示するタブを切り替えることができます。
また、画面上部に表示されているタブをクリックすることで、直接目的のタブを表示させることもできます。

設定を保存してダイアログボックスを閉じるには、[OK]ボタンを押します。
変更を破棄してダイアログボックスを閉じるには、[キャンセル]ボタンを押します。

４．４．１．１　一般
NPCの動作全般に関する設定を行います。

４．４．１．１．１　起動時に最新の情報を取得する
NPCを起動した際、自動的にビューの更新を行うか否かを設定します。
規定でチェックされています。

４．４．１．１．２　PeingID
ログインが必要な機能を利用する際に用いるPeingアカウントのIDを設定します。
なお、Twitterからの連携でPeingアカウントを作成した場合には、Twitterのアカウント名の先頭の@を消し、全ての英字を小文字にしたものがIDとなります。
設定を解除する場合には、IDと次の項目で詳述するパスワードを両方とも空欄としてください。

４．４．１．１．３　パスワード
IDと併せてPeingのログインに用いるパスワードを設定します。
なお、Twitterを含むSNSからの連携でPeingアカウントを作成した場合には、パスワードが設定されていない状態となります(2021年４月現在)。
その場合には、ここで設定を行う前に、ウェブや公式アプリからPeingにログインし、パスワードの設定を行ってください。
設定を解除する場合には、IDとパスワードを両方とも空欄としてください。

４．４．１．１．４　ログインした状態で質問する
質問の投稿の際に、ログインした状態で行うか否かを設定します。
ログインした状態で質問を行うことで、４．４．３で詳述した[送信した質問の表示]機能が利用できるようになります。
既定ではチェックされていません。
この項目を利用する場合には、IDおよびパスワードが正しく設定されている必要があります。

４．４．１．１．５　ログ記録レベル
NPCを起動すると、インストール先フォルダに「npc.log」というファイルが作成され、動作のログが記録されます。
この設定を使用して、記録される動作のログの詳細度を設定します。CRITICALやERRORに設定すると、ほとんど記録されません。ログファイルの容量を減らすことができます。
逆に、DEBUGに設定すると、詳細な動作の記録を得ることができます。
ここでの設定は、NPCの再起動後から有効になります。
万一不具合が発生した場合には、DEBUGレベルで動作を記録し、状況と併せてお送りいただけると、問題の迅速な特定と解決につながります。

４．４．１．２　表示/言語
画面表示に関する設定です。
また、NPCの表示言語を変更することもできます。

４．４．１．２．１　言語
NPCの表示に使用する言語を設定します。
ただし、質問・回答・回答者の表示名やプロフィールなどは、ここでの設定と関係なく、質問者・回答者が使用した言語での表示になります。
この設定を有効にするには、NPCの再起動が必要です。

４．４．１．２．２　画面表示モード
画面の表示方法を、[標準]、[ダーク]の間で設定します。
規定では[標準]に設定されています。
この設定を有効にするには、NPCの再起動が必要です。

４．４．１．２．３　テキストの折り返し
複数行のエディットボックスで、長い行を折り返して表示するかどうかを設定します。
[画面幅で折り返し]を選択すると、画面幅に合わせて折り返しが行われます。
規定では[折り返さない]に設定されています。

４．４．１．３　ネットワーク
NPCの自動更新や、Peingとの通信にプロキシサーバーを使用する場合に必要な設定を行います。

４．４．１．３．１　起動時に更新を確認
起動時にNPCの更新を確認するかどうかを設定します。
この設定は、規定でチェックされています。

４．４．１．３．２　プロキシサーバーの情報を手動で設定する
プロキシサーバーの情報を手動で設定するかどうかを設定します。
通常、NPCはWindowsに設定されたプロキシサーバーの情報を使用して接続を行いますが、何らかの理由で個別に設定したい場合は、この設定をチェックしてください。
この設定は、既定ではチェックされていません。

４．４．１．３．３　サーバーURL
[プロキシサーバーの情報を手動で設定する]が有効な場合に、プロキシサーバーのURLを設定します。

４．４．１．３．４　ポート番号
[プロキシサーバーの情報を手動で設定する]が有効な場合に、プロキシサーバーのポート番号を設定します。

４．４．２　リスト表示設定
ビューに表示する内容と、表示順序を設定します。
このメニュー項目を選択すると、[リスト表示設定]ダイアログボックスが表示されます。

[カラム]リストビューには、ビューに表示する内容が表示されます。
このリストでの表示順序は、ビューでの表示順序と一致しています。
ただし、このダイアログボックスを開いた時点で非表示に設定されている項目は、下に表示されます。

[表示]チェックボックスで、選択した内容を表示するかどうかを設定します。
[左へ]、[右へ]ボタンを使用して、並び順を変更できます。
[ヘッダを画面上で非表示にする]にチェックを入れると、ビューのヘッダに文字列を表示しないようにすることができます。この機能を利用すると、音声読み上げでの利用時に毎回の項目名の読上げが省略され、ビューの内容をより早く把握することができます。
設定を保存するには、[OK]ボタンを押します。
設定を破棄してダイアログボックスを閉じるには、[キャンセル]ボタンを押します。

４．４．３　ショートカットキーの設定
よく使う機能にショートカットキーを割り当てたり、すでに設定されている割り当てを変更したりできます。
ここで設定したショートカットキーは、NPCのウインドウが前面に表示され、アクティブになっている場合にのみ機能します。

[ショートカットキーの設定]ダイアログボックスには、以下の項目があります。
現在の登録内容：ショートカットキーを設定できるコマンドと、現在割り当てられているショートカットキーを表示します。該当する項目にショートカットキーが設定されていない場合は、「なし」と表示されます。
変更：選択した設定を変更します。
OK：設定を保存し、ダイアログボックスを閉じます。
キャンセル：設定を破棄し、ダイアログボックスを閉じます。

ショートカットキーを設定するには、以下の手順で操作します。
１．　[現在の登録内容]から、設定したい項目を選択します。
２．　[変更]ボタンを押します。
３．　[設定]ボタンを押します。
４．　設定したいキーの組み合わせを押します。ショートカットキーの割り当てを削除したい場合は、Escapeキーを押します。
なお、１つのコマンドについて、ショートカットキーを最大５個設定できます。

４．５　ヘルプ
４．５．１　バージョン情報
NPCのバージョン番号を確認できます。

４．５．２　更新を確認
新しいバージョンが利用可能かどうかを確認します。
画面の指示に従って操作してください。

第５章　その他
５．１　利用に当たっての注意事項
１．　登録したアカウントや過去に受信した回答のデータは、NPCのインストールディレクトリ内に「save.db」というファイル名で保存されます。
２．　同時に２つ以上のNPCを開いて操作したり、ファイル同期サービス等を用いて２つのコンピュータでsave.dbファイルを共有して同時起動した場合、ファイルが破損してしまう場合があります。万一ファイルが破損した場合、開発者にファイルをお送りいただいても復元はできません。
３．　４．４．１．１．２および４．４．１．１．３で設定したPeingのIDおよびパスワードは、「settings.ini」というファイル名で他の設定内容と併せて暗号化することなく保存されます。取り扱いには十分に注意してください。
４．　NPCの使用中、以下のようなメッセージが表示されることがあります。
----------
An error has occured. Contact to the developer for further assistance.
----------
このメッセージは、ソフトウェアに何らかの問題が起きていることを表しています。[OK]ボタンを押すと、自動的にNPCは終了します。
この現象が発生した場合、NPCをインストールしたフォルダ内に「errorlog.txt」というファイルが作成されています。
このファイルの内容とそれまでに行った操作を、開発者までお知らせください。
なお、save.dbファイルの破損の場合にもこのメッセージが表示されます。
もし、ファイル破損に心当たりがある場合には、問い合わせの前に、save.dbファイルを削除して、新規の状態からそのまま利用することをお試しください。

５．２　連絡先
このソフトウェアを利用しての感想やご要望、不具合のご報告などは、以下のメールアドレスまたは掲示板へご連絡ください。

ACT Laboratory サポート：support@actlab.org
ACT Laboratory 掲示板：https://actlab.org/bbs/
ACT Laboratory Twitter：https://twitter.com/act_laboratory

